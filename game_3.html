<!DOCTYPE HTML>
<html>
	<head>
		<title>Game 3</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<script src="https://kit.fontawesome.com/8c4d18466e.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/path/to/styles/default.css">
		<script src="/path/to/highlight.min.js"></script>
		<script>hljs.highlightAll();</script>
		<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">
				<!-- Header -->
					<header id="header">
						
					</header>
				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="index.html">Main page</a></li>
							<li><a href="about_me.html">About me</a></li>
							<li class="active"><a href="#">Post</a></li>
						</ul>
						<ul class="icons">
							<li><a href="https://www.facebook.com/VuHoangNguyennnnn" class="fab fa-facebook" style='font-size:26px'></a></li>		
							<li><a href="https://github.com/nnguyenu" class="fab fa-github" style='font-size:26px'></a></li>
							<li><a href="mailto:vuhoangnguyen7t1@gmail.com" class="fab fa-google" style='font-size:26px'></a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">
						<!-- Post -->
						<section class="post">
							<header class="major">
								<span class="date">May 28, 2021</span>
								<h1>Tập làm game (phần 3)</h1>
								<p>Tiếp tiếp tục code 1 số game cơ bản bằng Pygame</p>
							</header>
							<div class="image main"><img src="images/pygame/pygame_ava.png" alt="" /></div>
							<p>Ở trong phần 2 chúng ta đã hoàn thành con thỏ cũng như điều khiển nó. Ở phần này,
								mình sẽ tiếp tục hướng dẫn cách tạo class cho các con chuột chũi cũng như các mũi tên nhằm tạo ra 1 
								trò chơi hoàn thiện. Đầu tiên sẽ là mũi tên.</p>
							<h3>1. Mũi tên</h3>
                            <p>
                                Ta khởi tạo class Arrow tương tự như class Player. 
                            </p>
                            <pre><code class="python">class Arrow(pygame.sprite.Sprite):
    def __init__(self):
        super(Arrow,self).__init__()
        self.angle = p.angle
        self.surf = pygame.transform.rotate(arrow,360-to_deg(self.angle))
        self.rect = self.surf.get_rect(center=p.rect.center)
        self.speed = 15</code></pre>
                            <p>
                                Trong class Arrow có 1 thành viên "angle" có giá trị bằng góc người chơi đang nhìn hiện tại. Mỗi 
                                khi con thỏ bắn tên, mũi tên sẽ bắn ra từ trước mặt của con thỏ khi đó nên việc lưu lại góc bắn 
                                ra sẽ giúp ta mô phỏng được chuyển động của mũi tên trong mọi thời điểm. "surf" của mũi tên 
                                cũng sẽ xoay 1 góc bằng góc được bắn ra và "rect" cũng chính là "rect" của hình mũi tên trong 
                                resources tuy nhiên do ban đầu mũi tên được bắn ra từ con thỏ nên center của "rect" sẽ trùng 
                                với center của "p.rect". Mình cũng sẽ cho tốc độ của mũi tên là 15 (các bạn có thể tùy
                                chỉnh nếu muốn tên chạy nhanh hay chậm). Sau khi hoàn thành hàm khởi tạo ban đầu ta cũng cần
                                thêm 1 hàm cập nhật vị trí của mũi tên sau mỗi vòng lặp trò chơi (vòng lặp game mà mình đã
                                nhắc tới ở phần 1).
                            </p>
                            <pre><code class="python">def update(self):
    x = math.cos(self.angle)*self.speed
    y = math.sin(self.angle)*self.speed
    self.rect.move_ip(x,y)
    if self.rect.top < 0 or self.rect.bottom > height or self.rect.left < 0 or self.rect.right > width:
        self.kill()</code></pre>
                            <p>
                                Để cập nhật tọa độ \(x\) và \(y\) của 1 mũi tên thì ta chỉ cần lấy góc của mũi tên đó rồi 
                                nhân với tốc độ là sẽ ra được quãng đường mũi tên di chuyển được theo \(x\) và \(y\). 
                                Đồng thời nếu mũi tên chạy ra khỏi màn hình ta sẽ xóa mũi tên đó đi (self.kill()). 
                            </p>
                            <p>
                                Đến đây thì ta đã hoàn thành class Arrow tuy nhiên việc có thể bắn ra tên 1 cách tức thời sẽ
                                khiến người chơi có thể bắn ra tên liên tục khiến cho trò chơi trở nên quá dễ dàng cũng như
                                thiếu tính thực tế. Vì vậy bây giờ mình sẽ hướng dẫn cách thêm thời gian rút cung (reload time)
                                nhằm tạo 1 khoảng thời gian chờ giữa 2 lần bắn cung.
                            </p>
                            <h3>2. Rút cung</h3>
                            <p>
                                Để cho thuận tiện thì ta sẽ tạo 1 class tên "stop_watch" có chức năng như 1 đồng hồ bấm giờ 
                                với 2 chức năng chính. <br>
                                1. get: trả về thời gian trên đồng hồ hiện tại<br>
                                2. reset: đặt lại thời gian trên đồng hồ về 0<br>
                                Việc tạo 1 class riêng sẽ giúp ta chỉ cần gọi ".get" và ".reset" thay vì phải sử dụng câu 
                                lệnh trả về thời gian hiện tại (pygame.time.get_ticks()) liên tục.
                            </p>
                            <pre><code class="python">class stop_watch:
    def __init__(self):
        self.init_time = pygame.time.get_ticks()
    def get(self):
        return pygame.time.get_ticks()-self.init_time
    def reset(self):
        self.init_time = pygame.time.get_ticks()</code></pre>
                            <p>
                                Ban đầu khi ta khởi tạo thì ta sẽ lấy thời gian khi được khởi tạo (pygame.time.get_ticks()) 
                                làm mốc. Khi đó để lấy được khoảng thời gian từ lần khởi tạo gần nhất ta chỉ cần lấy thời 
                                gian hiện tại trừ đi thời gian gần nhất đồng hồ được khởi tạo. Để sử dụng stop_watch ta
                                khai báo: 
                            </p>
                            <pre><code class="python">timer = stop_watch()</code></pre>
                            <p>
                                
                            </p>
						</section>
					</div>

				<!-- Footer -->
					<footer id="footer">
						<section class="split contact">
							<section>
								<h3>Email</h3>
								<p>vuhoangnguyen7t1@gmail.com</p>
							</section>
						</section>
					</footer>
				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; nNguyeNn</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
					</div>
			</div>
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
	</body>
</html>